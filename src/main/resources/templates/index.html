<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>JWT Viewer</title>
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
            background: #f4f6fb;
            margin: 0;
            padding: 0;
        }
        h1 {
            text-align: center;
            font-weight: 700;
            margin-top: 40px;
            margin-bottom: 24px;
            letter-spacing: -1px;
        }
        .container {
            display: flex;
            gap: 32px;
            max-width: 900px;
            margin: 0 auto;
        }
        .panel {
            flex: 1;
            background: #fff;
            box-shadow: 0 4px 24px rgba(0,0,0,0.07);
            border-radius: 16px;
            padding: 32px 24px;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        label {
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }
        textarea {
            width: 100%;
            height: 180px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            padding: 12px;
            margin-bottom: 16px;
            background: #f8fafc;
            resize: vertical;
        }
        .result {
            white-space: pre-wrap;
            background: #f8fafc;
            padding: 16px;
            border-radius: 10px;
            font-size: 15px;
            border: 1px solid #e5e7eb;
            margin-bottom: 16px;
            min-height: 60px;
        }
        button {
            margin-top: 10px;
            padding: 10px 24px;
            font-size: 16px;
            background: #2563eb;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(37,99,235,0.08);
            transition: background 0.2s;
        }
        button:hover {
            background: #1d4ed8;
        }
        .radio-group {
            margin-bottom: 16px;
        }
        .json-view .key { color: #922; }
        .json-view .string { color: #080; }
        .json-view .number { color: #00f; }
        .json-view .boolean { color: #a52a2a; }
        .json-view .null { color: #b5b5b5; }
        @media (max-width: 900px) {
            .container { flex-direction: column; gap: 24px; }
        }
    </style>
</head>
<body>
    <h1>JWT Viewer</h1>
    <form method="post" action="/decode">
        <div class="container">
            <div class="panel">
                <label for="jwtToken">Paste JWT Token:</label><br>
                <textarea id="jwtToken" name="jwtToken" th:text="${jwtToken}"></textarea>
                <div style="margin-top:10px;">
                    <label><input type="radio" name="jwtType" value="signed" checked> Signed</label>
                    <label><input type="radio" name="jwtType" value="unsigned"> Unsigned</label>
                </div>
                <button type="submit">Decode</button>
            </div>
            <div class="panel">
                <label>Decoded Header:</label>
                <pre class="result json-view" id="headerJson" th:text="${headerJson}"></pre>
                <label style="margin-top:10px;">Decoded Payload:</label>
                <pre class="result json-view" id="payloadJson" th:text="${payloadJson}"></pre>
                <div th:if="${error}" style="color:red; margin-top:10px;">[[${error}]]</div>
                <script>
                function syntaxHighlight(json) {
                    if (!json) return '';
                    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                    return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?)|(\b(true|false|null)\b)|(-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
                        var cls = 'number';
                        if (/^"/.test(match)) {
                            if (/:$/.test(match)) {
                                cls = 'key';
                            } else {
                                cls = 'string';
                            }
                        } else if (/true|false/.test(match)) {
                            cls = 'boolean';
                        } else if (/null/.test(match)) {
                            cls = 'null';
                        }
                        return '<span class="' + cls + '">' + match + '</span>';
                    });
                }
                document.addEventListener('DOMContentLoaded', function() {
                    var headerElem = document.getElementById('headerJson');
                    var payloadElem = document.getElementById('payloadJson');
                    var header = headerElem.textContent.trim();
                    var payload = payloadElem.textContent.trim();
                    try {
                        header = JSON.stringify(JSON.parse(header), null, 2);
                    } catch(e) {}
                    try {
                        payload = JSON.stringify(JSON.parse(payload), null, 2);
                    } catch(e) {}
                    headerElem.innerHTML = syntaxHighlight(header);
                    payloadElem.innerHTML = syntaxHighlight(payload);
                });
                </script>
                <style>
                .json-view .key { color: #922; }
                .json-view .string { color: #080; }
                .json-view .number { color: #00f; }
                .json-view .boolean { color: #a52a2a; }
                .json-view .null { color: #b5b5b5; }
                </style>
            </div>
        </div>
    </form>
</body>
</html>
